<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ManhMusic</title>
    <script>
        // Handle OAuth callback on wrong path, preserve hash with tokens
        const hash = window.location.hash || '';
        const search = window.location.search || '';
        const pathname = window.location.pathname || '';
        const hasOAuthParams = /access_token=|refresh_token=|code=/.test(hash + search);
        const base = '/manh-music/';

        if (hasOAuthParams) {
            // OAuth callback detected - redirect to correct path preserving hash
            if (pathname === '/player.html' || pathname.endsWith('/player.html')) {
                console.log('404: OAuth callback to /player.html, redirecting to correct base path');
                window.location.replace(`${window.location.origin}${base}player.html${hash}`);
            } else {
                console.log('404: OAuth callback, redirecting to base with hash');
                window.location.replace(`${window.location.origin}${base}${hash}`);
            }
        } else {
            // Regular 404, redirect to home
            window.location.replace(`${window.location.origin}${base}`);
        }
    </script>
</head>
<body>
    <p>Redirecting...</p>
</body>
</html>